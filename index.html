<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Smart Scheduler Portal</title>
<style>
  :root {
    --bg:#0e1014; --panel:#181a1f; --muted:#9aa0a6; --accent:#6ee7b7; --card:#1c1f26; --accent-dark:#4ad1a2;
  }
  *{box-sizing:border-box;margin:0;padding:0;}
  html,body{height:100%;font-family:Inter,Segoe UI,Arial,sans-serif;}
  body{
    background:linear-gradient(135deg,#0f1115,#1a1d24);
    color:#e6eef6;display:flex;flex-direction:column;
  }
  header{
    display:flex;justify-content:space-between;align-items:center;
    padding:12px 24px;background:var(--panel);
    box-shadow:0 2px 8px rgba(0,0,0,0.6);
    position:sticky;top:0;z-index:10;
  }
  .logo{font-weight:700;font-size:20px;color:var(--accent);}
  nav{display:flex;gap:8px;}
  nav button{
    padding:8px 16px;border:none;border-radius:20px;
    background:transparent;color:var(--muted);cursor:pointer;
    font-size:14px;transition:all 0.25s;
  }
  nav button:hover{color:#fff;background:rgba(255,255,255,0.08);}
  nav button.active{background:var(--accent);color:#000;font-weight:600;}
  
  #loginBoxSmall{display:flex;align-items:center;gap:8px;font-size:13px;}
  #loginBoxSmall input{
    padding:6px 10px;border-radius:20px;border:none;
    background:var(--card);color:#fff;outline:none;
  }
  #loginBoxSmall button{
    padding:6px 14px;border:none;border-radius:20px;
    background:var(--accent);color:#000;font-weight:600;
    cursor:pointer;transition:background 0.2s;
  }
  #loginBoxSmall button:hover{background:var(--accent-dark);}
  #loginStatus{color:var(--muted);}
  
  .wrap{padding:24px;flex:1;max-width:1200px;margin:auto;width:100%;}
  .panel{
    background:rgba(28,31,38,0.95);
    padding:24px;border-radius:16px;margin-top:16px;
    box-shadow:0 4px 20px rgba(0,0,0,0.5);
    animation:fadeIn 0.4s ease;
  }
  h2{margin-bottom:12px;color:#fff;}
  h3{margin-top:20px;color:#fff;}
  label{font-size:14px;color:var(--muted);}
  input,select{
    padding:8px 12px;margin:6px 0;border-radius:10px;border:1px solid #333;
    background:var(--card);color:#fff;width:100%;outline:none;
    transition:border 0.2s;
  }
  input:focus,select:focus{border-color:var(--accent);}
  
  table{border-collapse:collapse;width:100%;margin-top:10px;border-radius:10px;overflow:hidden;}
  th,td{border:1px solid rgba(255,255,255,0.1);padding:8px;text-align:center;font-size:14px;}
  th{background:rgba(255,255,255,0.05);}
  
  .controls{margin-top:12px;display:flex;gap:10px;flex-wrap:wrap;}
  .btn{
    padding:10px 16px;border:none;border-radius:10px;cursor:pointer;
    font-size:14px;transition:all 0.2s;
  }
  .btn.primary{background:var(--accent);color:#000;font-weight:600;}
  .btn.primary:hover{background:var(--accent-dark);}
  .btn:hover{opacity:0.9;}
  
  .hidden{display:none;}
  
  .deptList button{
    display:block;width:100%;margin:8px 0;padding:14px 16px;border-radius:12px;
    background:var(--card);color:#fff;text-align:left;cursor:pointer;
    border:none;font-size:15px;transition:all 0.2s;
  }
  .deptList button:hover{background:#2c3039;transform:translateX(3px);}
  
  @keyframes fadeIn{from{opacity:0;transform:translateY(8px);}to{opacity:1;transform:translateY(0);}}
</style>
</head>
<body>
<header>
  <div class="logo">Smart Scheduler</div>
  <nav>
    <button class="navBtn active" data-view="dashboard">Dashboard</button>
    <button class="navBtn" data-view="timetable">Timetable</button>
    <button class="navBtn" data-view="marks">Marks</button>
  </nav>
  <div id="loginBoxSmall">
    <span id="loginStatus">Not logged in</span>
    <input id="loginUser" placeholder="Username">
    <button id="loginBtn">Login</button>
    <button id="logoutBtn" class="hidden">Logout</button>
  </div>
</header>

<div class="wrap">

  <!-- DASHBOARD -->
  <section id="dashboard" class="panel">
    <h2>Departments</h2>
    <div class="deptList" id="deptList"></div>
    <div class="controls">
      <input id="newDeptName" placeholder="Enter Department Name">
      <button class="btn primary" id="addDeptBtn">Add Department</button>
    </div>
  </section>

  <!-- DEPARTMENT CONFIG -->
  <section id="deptConfig" class="panel hidden">
    <h2 id="deptTitle">Configure Department</h2>
    <div>
      <label>No. of Sections</label>
      <input id="numSections" type="number" min="1" value="1">
    </div>
    <div>
      <label>Subjects (comma separated)</label>
      <input id="subjectsInput" placeholder="Maths, Physics, DSA">
    </div>
    <div>
      <label>Days</label>
      <input id="days" type="number" min="1" value="5">
    </div>
    <div>
      <label>Periods per Day</label>
      <input id="periods" type="number" min="1" value="6">
    </div>

    <h3>Faculty List</h3>
    <table id="facultyTable">
      <tr><th>Faculty Name</th><th>Subject</th><th>Action</th></tr>
    </table>
    <div class="controls">
      <input id="facName" placeholder="Faculty Name">
      <input id="facSubject" placeholder="Subject">
      <button class="btn primary" id="addFaculty">Add Faculty</button>
    </div>

    <div class="controls">
      <button class="btn primary" id="saveDeptBtn">Save & Generate Timetables</button>
      <button class="btn" id="backBtn">‚Üê Back to Departments</button>
    </div>
  </section>

  <!-- TIMETABLE -->
  <section id="timetable" class="panel hidden">
    <h2>Generated Timetables</h2>
    <label>Select Department</label>
    <select id="deptSelect"></select>
    <label>Select Section</label>
    <select id="sectionSelect"></select>
    <div id="timetableWrapper"></div>
  </section>

  <!-- MARKS -->
  <section id="marks" class="panel hidden">
    <h2>Marks Section (Coming Soon)</h2>
  </section>

</div>

<script>
const $=s=>document.querySelector(s);
const $all=s=>Array.from(document.querySelectorAll(s));

let departments={};
let currentDept=null;

// ============ LOGIN (Username only) ============
$('#loginBtn').onclick=()=>{
  const u=$('#loginUser').value.trim();
  if(u){
    $('#loginStatus').textContent = `Hello, ${u}`;
    $('#loginUser').classList.add('hidden');
    $('#loginBtn').classList.add('hidden');
    $('#logoutBtn').classList.remove('hidden');
  } else {
    alert("Enter a username");
  }
};
$('#logoutBtn').onclick=()=>{
  $('#loginStatus').textContent = "Not logged in";
  $('#loginUser').classList.remove('hidden');
  $('#loginBtn').classList.remove('hidden');
  $('#logoutBtn').classList.add('hidden');
};

// ============ DASHBOARD ============
function renderDeptList(){
  const list=$('#deptList');
  list.innerHTML='';
  Object.keys(departments).forEach(name=>{
    const btn=document.createElement('button');
    btn.textContent=name;
    btn.onclick=()=>openDeptConfig(name);
    list.appendChild(btn);
  });
}
$('#addDeptBtn').onclick=()=>{
  const name=$('#newDeptName').value.trim();
  if(!name)return alert("Enter department name");
  if(departments[name])return alert("Already exists");
  departments[name]={faculty:[],subjects:[],numSections:1,days:5,periods:6,timetables:{}};
  $('#newDeptName').value='';
  renderDeptList();
};

// ============ DEPT CONFIG ============
function openDeptConfig(name){
  currentDept=name;
  const d=departments[name];
  $('#deptTitle').textContent=`Configure ${name}`;
  $('#numSections').value=d.numSections;
  $('#subjectsInput').value=d.subjects.join(', ');
  $('#days').value=d.days;
  $('#periods').value=d.periods;
  renderFacultyTable();
  showView('deptConfig');
}
function renderFacultyTable(){
  const t=$('#facultyTable');
  const d=departments[currentDept];
  t.innerHTML='<tr><th>Faculty Name</th><th>Subject</th><th>Action</th></tr>';
  d.faculty.forEach((f,i)=>{
    const row=document.createElement('tr');
    row.innerHTML=`<td>${f.name}</td><td>${f.subject}</td>
      <td><button onclick="removeFaculty(${i})">Delete</button></td>`;
    t.appendChild(row);
  });
}
function removeFaculty(i){
  departments[currentDept].faculty.splice(i,1);
  renderFacultyTable();
}
$('#addFaculty').onclick=()=>{
  const n=$('#facName').value.trim();
  const s=$('#facSubject').value.trim();
  if(!n||!s)return alert("Enter both fields");
  departments[currentDept].faculty.push({name:n,subject:s});
  $('#facName').value='';$('#facSubject').value='';
  renderFacultyTable();
};
$('#backBtn').onclick=()=>showView('dashboard');

$('#saveDeptBtn').onclick=()=>{
  const d=departments[currentDept];
  d.numSections=parseInt($('#numSections').value)||1;
  d.subjects=$('#subjectsInput').value.split(',').map(s=>s.trim()).filter(Boolean);
  d.days=parseInt($('#days').value)||5;
  d.periods=parseInt($('#periods').value)||6;
  if(!d.subjects.length||!d.faculty.length){
    return alert("Add subjects and faculty first");
  }
  d.timetables=generateMultiSectionTimetables(d);
  populateDeptSelector();
  showView('timetable');
};

// ============ TIMETABLE ============
function generateMultiSectionTimetables(dept){
  const {numSections,days,periods,subjects,faculty}=dept;
  const subjectFacultyMap={};
  faculty.forEach(f=>{
    if(!subjectFacultyMap[f.subject])subjectFacultyMap[f.subject]=[];
    subjectFacultyMap[f.subject].push(f.name);
  });
  const result={};
  for(let sec=1;sec<=numSections;sec++){
    const table=[];
    for(let d=0;d<days;d++){
      const row=[];
      for(let p=0;p<periods;p++){
        const subj=subjects[Math.floor(Math.random()*subjects.length)];
        let facList=subjectFacultyMap[subj]||[];
        let teacher=facList.length? facList[(sec+d+p)%facList.length] : "TBA";
        row.push({subject:subj,faculty:teacher});
      }
      table.push(row);
    }
    result[`Section ${sec}`]=table;
  }
  return result;
}
function populateDeptSelector(){
  const sel=$('#deptSelect');
  sel.innerHTML='';
  Object.keys(departments).forEach(name=>{
    const opt=document.createElement('option');
    opt.value=name;opt.textContent=name;
    sel.appendChild(opt);
  });
  sel.onchange();
}
$('#deptSelect').onchange=()=>{
  const deptName=$('#deptSelect').value;
  const d=departments[deptName];
  const sel=$('#sectionSelect');
  sel.innerHTML='';
  Object.keys(d.timetables).forEach(sec=>{
    const opt=document.createElement('option');
    opt.value=sec;opt.textContent=sec;
    sel.appendChild(opt);
  });
  renderTimetable(deptName,sel.value);
};
$('#sectionSelect').onchange=()=>{
  renderTimetable($('#deptSelect').value,$('#sectionSelect').value);
};
function renderTimetable(deptName,sec){
  const t=departments[deptName].timetables[sec];
  if(!t)return;
  const periods=departments[deptName].periods;
  let html='<table><tr><th>Day/Period</th>';
  for(let p=1;p<=periods;p++)html+=`<th>P${p}</th>`;
  html+='</tr>';
  t.forEach((row,di)=>{
    html+=`<tr><td>Day ${di+1}</td>`;
    row.forEach(cell=>{
      html+=`<td>${cell.subject}<br><small>${cell.faculty}</small></td>`;
    });
    html+='</tr>';
  });
  html+='</table>';
  $('#timetableWrapper').innerHTML=html;
}

// ============ NAVIGATION ============
function showView(v){
  $all('section').forEach(s=>s.classList.add('hidden'));
  $('#'+v).classList.remove('hidden');
  $all('.navBtn').forEach(b=>b.classList.toggle('active',b.dataset.view===v));
}
$all('.navBtn').forEach(b=>b.onclick=()=>showView(b.dataset.view));
</script>
</body>
</html>
